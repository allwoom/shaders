<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <title>Starfield Shader</title>
    <link rel="stylesheet" href="starfield.css" />

    <script type="x-shader/x-vertex" id="vertexShader">//<![CDATA[]
            // an attribute will receive data from a buffer
            attribute vec4 a_position;
            
            void main() {
                // gl_Position is a special variable a vertex shader is responsible for setting
                gl_Position = a_position;
            }
            //]]>
    </script>

    <script type="x-shader/x-fragment" id="fragmentShader">//<![CDATA[]          
            #ifdef GL_ES
                precision mediump float;
            #endif

            uniform vec2 resolution; // canvas resolution
            uniform float time;      // elapsed time since program started

            
            // 2D Random
            float rand (in vec2 st) {
                return fract(sin(dot(st.xy,
                         vec2(12.9898,78.233)))
                 * 43758.5453123);
            }

            float noise (in vec2 st) {
                vec2 i = floor(st);
                vec2 f = fract(st);
            
                // Four corners in 2D of a tile
                float a = rand(i);
                float b = rand(i + vec2(1.0, 0.0));
                float c = rand(i + vec2(0.0, 1.0));
                float d = rand(i + vec2(1.0, 1.0));
            
                // Smooth Interpolation
            
                // Cubic Hermine Curve.  Same as SmoothStep()
                vec2 u = f*f*(3.0-2.0*f);
                // u = smoothstep(0.,1.,f);
            
                // Mix 4 coorners percentages
                return mix(a, b, u.x) +
                        (c - a)* u.y * (1.0 - u.x) +
                        (d - b) * u.x * u.y;
            }

            void main() {
                vec2 st = gl_FragCoord.xy;
                st.x += time * 30.0;
                vec4 spaceColor = vec4(0.1, 0.1, 0.15, 1.0);

                float strength = smoothstep(0.9, 1.0, noise(st));
                vec3 starColor = vec3(1.0, 1.0, 0.9);
                vec4 finalColor = vec4(starColor * strength, 1.0);

                gl_FragColor = finalColor + spaceColor;
            }
            //]]>
    </script>

    <script src="shaderHelper.js" type="text/javascript"></script>
    <script src="starfield.js" type="text/javascript"></script>
</head>

<body>
    <canvas id="glCanvas" width="1000" height="600">
        </canvas>

    <div id="console"></div>
</body>

</html>